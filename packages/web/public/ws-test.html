<!doctype html>
<html>
  <head>
    <title>WebSocket Test</title>
  </head>
  <body>
    <h1>WebSocket Test</h1>
    <div id="status">Not connected</div>
    <div id="log"></div>
    <script>
      const statusEl = document.getElementById("status");
      const logEl = document.getElementById("log");

      function log(msg) {
        console.log(msg);
        logEl.innerHTML += msg + "<br>";
      }

      // TODO: Replace <your-subdomain> with your Cloudflare Workers subdomain
      const url =
        "wss://open-inspect-control-plane.<your-subdomain>.workers.dev/sessions/test123/ws";
      log("Connecting to: " + url);
      log("NOTE: Update the URL above with your actual subdomain before testing");
      statusEl.textContent = "Connecting...";

      const ws = new WebSocket(url);

      ws.onopen = () => {
        log("Connected!");
        statusEl.textContent = "Connected";
        ws.send(JSON.stringify({ type: "ping" }));
      };

      ws.onmessage = (event) => {
        log("Received: " + event.data);
      };

      ws.onerror = (error) => {
        log("Error: " + JSON.stringify(error));
        statusEl.textContent = "Error";
      };

      ws.onclose = (event) => {
        log(
          "Closed: code=" + event.code + ", reason=" + event.reason + ", wasClean=" + event.wasClean
        );
        statusEl.textContent = "Closed";
      };
    </script>
  </body>
</html>
